<!doctype html>
<html class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>报表控制</title>
<meta name="description" content="这是一个 index 页面">
<meta name="keywords" content="index">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="icon" type="image/png" href="assets/i/favicon.png">
<link rel="apple-touch-icon-precomposed"
	href="assets/i/app-icon72x72@2x.png">
<meta name="apple-mobile-web-app-title" content="Amaze UI" />
<link rel="stylesheet" href="assets/css/amazeui.min.css" />
<link rel="stylesheet" href="assets/css/admin.css">
</head>
<body>
	<!--[if lte IE 9]>
<p class="browsehappy">你正在使用<strong>过时</strong>的浏览器，Amaze UI 暂不支持。 请 <a href="http://browsehappy.com/" target="_blank">升级浏览器</a>
  以获得更好的体验！</p>
<![endif]-->

	<header class="am-topbar admin-header">
		<div class="am-topbar-brand">
				<strong>报表控制</strong> 
		</div>

		<button
			class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only"
			data-am-collapse="{target: '#topbar-collapse'}">
			<span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span>
		</button>

		<div class="am-collapse am-topbar-collapse" id="topbar-collapse">

			<ul
				class="am-nav am-nav-pills am-topbar-nav am-topbar-right admin-header-list">
				 <li><a href="./index.jsp">报表展示首页</a></li>
				<li class="am-hide-sm-only"><a href="javascript:;"
					id="admin-fullscreen"><span class="am-icon-arrows-alt"></span>
						<span class="admin-fullText">开启全屏</span></a></li>
						
			</ul>
		</div>
	</header>
	
		<!-- content start -->
		
	<div class="am-cf admin-main">
		<!-- sidebar start -->
		<div class="admin-sidebar am-offcanvas" id="admin-offcanvas">
			<div class=" admin-offcanvas-bar">
				<ul class="am-list admin-sidebar-list">
					<li  class="am-round"><a href="index.html"><span class=" am-icon-home"></span>首页</a></li>
					<li id="config1" class="am-round "><a class="am-cf" data-am-collapse="{target: '#collapse-nav'}"><span class="am-icon-cogs"></span>报表设置 <span
							class="am-icon-angle-right am-fr am-margin-right"></span></a>
						<ul class="am-list am-collapse admin-sidebar-sub"
							id="collapse-nav">
							<li id="config2" class="am-round"><a href="#" data-am-collapse="{target: '#collapse-nav1'}"><span class="am-icon-th"></span>引流报表</a>
													<ul class="am-list am-collapse admin-sidebar-sub"
														id="collapse-nav1">
														<li ><a href="admin-index.html"><span class="am-icon-cog"></span>引流报表定义</a></li>
							
																
														<li><a href="admin-index.html"><span class="am-icon-cog"></span> 引流报表配置</a></li>
														<li><a href="admin-referer-site.html"><span class="am-icon-cog"></span> 引流站点配置</a></li>
														<li><a href="admin-activity.html"><span class="am-icon-cog"></span> 活动配置</a></li>
														</ul>
							</li>
								
									
							<li id="config3" class="am-round"><a href="#" data-am-collapse="{target: '#collapse-nav2'}"><span class="am-icon-th"></span> 助攻报表</a>
														<ul class="am-list am-collapse admin-sidebar-sub"
														id="collapse-nav2">
														<li ><a href="pageServer.action?to=assistReportIndex"><span class="am-icon-cog"></span>助攻报表定义</a></li>
														<li><a href="pageServer.action?to=assistReportIndex"><span class="am-icon-cog"></span> 助攻报表配置</a></li>
														<li><a href="pageServer.action?to=assistReportIndex"><span class="am-icon-cog"></span> 非核心助攻渠道配置</a></li>
														</ul>
							
							</li>
						</ul>
					</li>
				</ul>

			</div>
		</div>

		<!-- sidebar end -->


		
		 <div class="admin-content">

    <div class="am-cf am-padding">
      <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">活动列表</strong> / <small>Table</small></div>
    </div>

    <div class="am-g">
      <div class="am-u-sm-12 am-u-md-6">
        <div class="am-btn-toolbar">
          <div class="am-btn-group am-btn-group-xs">
           <a href="#"> <button type="button" class="am-btn am-btn-default" data-am-modal="{target: '#addmodule', closeViaDimmer: 0, width: 550, height: 550}"><span class="am-icon-plus"></span> 新增</button></a>
             <a href="#"> <button id="delete" type="button" class="am-btn am-btn-default"><span class="am-icon-trash-o"></span> 删除</button></a>
             <a href="#" > <button id="update" type="button" class="am-btn am-btn-default" ><span class="am-icon-archive" ></span> 修改</button></a>
             <a href="#" > <button id="look" type="button" class="am-btn am-btn-default" ><span class="am-icon-archive" ></span>查看pattern</button></a>
          </div>
        </div>
      </div>

    </div>

    <div class="am-g">
      <div class="am-u-sm-12">
        <form class="am-form">
          <table class="am-table am-table-striped am-table-hover table-main">
            <thead>
              <tr>
                <th class="table-check"></th><th class="table-title">姓名</th><th class="table-title">性别</th><th class="table-title">地址</th><th class="table-title">电话</th>
              </tr>
          </thead>
            <tbody id="tbody">
          </tbody>
        </table>
		
          <div id="pager" ></div>
          <hr />
      
        </form>
      </div>
    </div>
  </div>
  </div>
  

<!-- add module -->
<div class="am-modal am-modal-no-btn"  tabindex="-1" id="addmodule">
  <div class="am-modal-dialog">
    <div class="am-modal-hd">添加
      <a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close>&times;</a>
    </div>
    <div class="am-modal-bd">
     	<form class="am-form" >

           <div class="am-g am-margin-top">
	            <div class="am-u-sm-5 am-u-md-4 am-text-left">
	            活动名称
	            </div>
	            <div class="am-u-sm-5 am-u-md-5">
	             <input id="name" type="text" class="am-input-sm" >
	            </div>
          </div>
        
	        <div class="am-g am-margin-top">
	          <div class="am-u-sm-5 am-u-md-4 am-text-left">
	           索引号
	          </div>
	          <div class="am-u-sm-5 am-u-md-5">
	            <input id="sortindex" type="text" class="am-input-sm" >
	          </div>
	        </div>
          
          <div class="am-margin">
		    <button id="submit" type="button" class="am-btn am-btn-primary am-btn-xs">提交保存</button>
		    <button id="cancle" type="button" class="am-btn am-btn-primary am-btn-xs">放弃保存</button>
		  </div>
          
        </form>
    </div>
  </div>
</div>



<!-- update module -->
<div class="am-modal am-modal-no-btn"  tabindex="-1" id="updatemodule">
  <div class="am-modal-dialog">
    <div class="am-modal-hd">修改
      <a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close>&times;</a>
    </div>
    <div class="am-modal-bd">
     	<form class="am-form" >
		  <div class="am-g am-margin-top">
	            <div class="am-u-sm-5 am-u-md-4 am-text-left">
	             活动ID
	            </div>
	            <div class="am-u-sm-5 am-u-md-5">
	             <input disabled="disabled"  id="id2" type="text" class="am-input-sm">
	            </div>
          </div>
          

          
           <div class="am-g am-margin-top">
	            <div class="am-u-sm-5 am-u-md-4 am-text-left">
	              活动名称
	            </div>
	            <div class="am-u-sm-5 am-u-md-5">
	             <input id="name2" type="text" class="am-input-sm">
	            </div>
          </div>
        
	        <div class="am-g am-margin-top">
	          <div class="am-u-sm-5 am-u-md-4 am-text-left">
	             索引号
	          </div>
	          <div class="am-u-sm-5 am-u-md-5">
	            <input id="sortIndex2" type="text" class="am-input-sm">
	          </div>
	        </div>


          <div class="am-margin">
		    <button id="submit2" type="button" class="am-btn am-btn-primary am-btn-xs">提交保存</button>
		    <button id="cancle2" type="button" class="am-btn am-btn-primary am-btn-xs">放弃保存</button>
		  </div>
          
        </form>
    </div>
  </div>
</div>
	
		<!-- content end -->





	<!--[if lt IE 9]>
<script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="assets/js/polyfill/rem.min.js"></script>
<script src="assets/js/polyfill/respond.min.js"></script>
<script src="assets/js/amazeui.legacy.js"></script>
<![endif]-->

	<!--[if (gte IE 9)|!(IE)]><!-->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/amazeui.min.js"></script>
	<!--<![endif]-->
	<script src="assets/js/app.js"></script>
	 <script src="./js/jquery.pager.js" type="text/javascript"></script>		
	  <link href="./css/Pager.css" rel="stylesheet" type="text/css" />
	<script>


    PageClick = function(pageclickednumber) {
        $("#pager").pager({ pagenumber: pageclickednumber, pagecount: total, buttonClickCallback: PageClick });
		$.ajax({
			type : "GET",
			url : "ws/activity/activity/page/"+pageclickednumber,       
			dataType : "json",
			success : function(data) {
				   createShowingTable(data)
			},
			error : function(data) {
	
				alert("error occured");
			}
		})
        
    }
	

		function createShowingTable(data) {
			alert("------->进入当前的数据展现");
			//此处需要让其动态的生成一个table并填充数据  
			var tableStr = ""
			var len = data.length;
			for (var i = 0; i < len; i++) {
				tableStr = tableStr + "<tr><th class='table-check'><input type='checkbox' /></th><td style='display:none;'>"+data[i].id+"</td><td>"+data[i].name+"</td><td >"+data[i].gender+"</td><td >"+data[i].address+"</td><td >"+data[i].telephone+"</td></tr>";
			}
			//将动态生成的table添加的事先隐藏的div中.  
			$("#tbody").html(tableStr);
			$("table").show();
		}

	     function getList() {
							$.ajax({
										type : "GET",
										url : "../json/demo7.json",
										dataType : "json",
										success : function(data) {
											createShowingTable(data)
											
										},
										error : function(data) {
								
											alert("error occured");
										}
									})

						}
	     

	    	 				
	 		$("#submit").click(
	 				function(){
	 					var name = $("#name").val();
	 					var sortindex = $("#sortindex").val();
	 					 var $modal = $('#addmodule');
	 					 if(name == "" ){
	 						 alert("表单填写不完整")
	 						 return;
	 					 }
	 					 if(sortindex != "" && !$.isNumeric(sortindex)){
	 						 alert("索引号应为数字");
	 						 return;
	 					 }
	 					$.ajax({ 
	 						url: "ws/activity/activity/add/",
	 						type:"POST",
	 						data:JSON.stringify({"name":name,"sortindex":sortindex}),
	 						contentType: 'application/json', 
	 						dataType: "json",
	 						success: function(data){
	 							
	 							$modal.modal('close');
	 							alert("success");
	 							window.location.href= "admin-activity.html"
	 					  	
	 						},
	 						error:function(){
	 							
	 							alert("error occured");
	 						}

	 				})   
	 				})
	 $("#cancle").click(function(){
			 var $modal = $('#addmodule');

			 $modal.modal('close');
		})
		
	 $("#cancle2").click(function(){
			 var $modal = $('#updatemodule');

			 $modal.modal('close');
		})
		
  $("#delete").click(
		function(){
			if($("#tbody input[type='checkbox']:checked").length != 1){
					alert("请选择一项");
					return;
				}else{
					var id = $("#tbody input[type='checkbox']:checked").parent().parent().find('td:nth-child(2)').text();
				//	alert(id);
					$.ajax({ 
						url: "ws/activity/activity/delete/"+id,
						type:"DELETE",
						contentType: 'application/json', 
						dataType: "json",
						success: function(data){
							
							alert("success");
							window.location.href= "admin-activity.html"
					  	
						},
						error:function(){
							
							alert("error occured");
						}
				})  
				}
		})	
		
		
  $("#update").click(
		function(){
			if($("#tbody input[type='checkbox']:checked").length != 1){
					alert("请选择一项");
					return;
				}else{
					var id = $("#tbody input[type='checkbox']:checked").parent().parent().find('td:nth-child(2)').text();
					var name = $("#tbody input[type='checkbox']:checked").parent().parent().find('td:nth-child(3)').text();
					var sortIndex = $("#tbody input[type='checkbox']:checked").parent().parent().find('td:nth-child(4)').text();
					$("#id2").val(id);
					$("#name2").val(name);
					$("#sortIndex2").val(sortIndex);
					 var $modal = $('#updatemodule');
					 $modal.modal('open');
 
				}
		})
		
		
	 		$("#submit2").click(
	 				function(){
	 					var id = $("#id2").val();
	 					var name = $("#name2").val();
	 					var sortIndex = $("#sortIndex2").val();
	 					 var $modal = $('#updatemodule');
	 					 if(name == "" ){
	 						 alert("表单填写不完整")
	 						 return;
	 					 }
	 					 if(sortIndex != "" && !$.isNumeric(sortIndex)){
	 						 alert("索引号应为数字");
	 						 return;
	 					 }
	 					 var data = {"id":id,"name":name,"sortIndex":sortIndex}
	 					$.ajax({ 
							url: "ws/activity/activity/update/", 
							type:"PUT",
							contentType: 'application/json', 
							data: JSON.stringify(data),
							dataType: "json",
							success: function(data){
								$modal.modal("close");
								alert("success");
								window.location.href= "admin-activity.html"
						  	
							},
							error:function(){
								
								alert("error occured");
							}
					})   
	 				})
	 	
	 				
	 				
	 	$("#look").click(
		function(){
			if($("#tbody input[type='checkbox']:checked").length != 1){
					alert("请选择一项");
					return;
				}else{
					var id = $("#tbody input[type='checkbox']:checked").parent().parent().find('td:nth-child(2)').text();
					window.location.href = "pageServer.action?to=actPattern&id="+id
				}
		})
				
	 				
	 				
	     var total;
	     getList();
	     
	     $("#hdfs").click(	
					function (){
						$.ajax({ 
							url: "hdfs.action", 
							data: {"action":"Act"},
							type:"POST",
							success: function(){					
								alert("success");	
							},
							error:function(){	
								alert("error occured");
							}
					});
			});		     
	</script>
</body>
</html>
