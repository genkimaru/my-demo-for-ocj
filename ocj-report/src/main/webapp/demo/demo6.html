<!doctype html>
<html class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>报表控制</title>
<meta name="description" content="这是一个 index 页面">
<meta name="keywords" content="index">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="icon" type="image/png" href="assets/i/favicon.png">
<link rel="apple-touch-icon-precomposed"
	href="assets/i/app-icon72x72@2x.png">
<meta name="apple-mobile-web-app-title" content="Amaze UI" />
<link rel="stylesheet" href="assets/css/amazeui.min.css" />
<link rel="stylesheet" href="assets/css/admin.css">
</head>
<body>
	<!--[if lte IE 9]>
<p class="browsehappy">你正在使用<strong>过时</strong>的浏览器，Amaze UI 暂不支持。 请 <a href="http://browsehappy.com/" target="_blank">升级浏览器</a>
  以获得更好的体验！</p>
<![endif]-->

	<header class="am-topbar admin-header">
		<div class="am-topbar-brand">
				<strong>报表控制</strong> 
		</div>

		<button
			class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only"
			data-am-collapse="{target: '#topbar-collapse'}">
			<span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span>
		</button>

		<div class="am-collapse am-topbar-collapse" id="topbar-collapse">

			<ul
				class="am-nav am-nav-pills am-topbar-nav am-topbar-right admin-header-list">
				<li><a href="./index.jsp">报表展示首页</a></li>
				<li class="am-hide-sm-only"><a href="javascript:;"
					id="admin-fullscreen"><span class="am-icon-arrows-alt"></span>
						<span class="admin-fullText">开启全屏</span></a></li>
			</ul>
		</div>
	</header>
	
		<!-- content start -->
		
	<div class="am-cf admin-main">
		<!-- sidebar start -->
		<div class="admin-sidebar am-offcanvas" id="admin-offcanvas">
			<div class=" admin-offcanvas-bar">
				<ul class="am-list admin-sidebar-list">
					<li  class="am-round"><a href="index.html"><span class=" am-icon-home"></span>首页</a></li>
					<li id="config1" class="am-round "><a class="am-cf" data-am-collapse="{target: '#collapse-nav'}"><span class="am-icon-cogs"></span>报表设置 <span
							class="am-icon-angle-right am-fr am-margin-right"></span></a>
						<ul class="am-list am-collapse admin-sidebar-sub"
							id="collapse-nav">
							<li id="config2" class="am-round"><a href="#" data-am-collapse="{target: '#collapse-nav1'}"><span class="am-icon-th"></span>引流报表</a>
													<ul class="am-list am-collapse admin-sidebar-sub"
														id="collapse-nav1">
														<li ><a href="admin-index.html"><span class="am-icon-cog"></span>引流报表定义</a></li>
							
																
														<li><a href="admin-index.html"><span class="am-icon-cog"></span> 引流报表配置</a></li>
														<li><a href="admin-referer-site.html"><span class="am-icon-cog"></span> 引流站点配置</a></li>
														<li><a href="admin-activity.html"><span class="am-icon-cog"></span> 活动配置</a></li>
														</ul>
							</li>
								
									
							<li id="config3" class="am-round"><a href="#" data-am-collapse="{target: '#collapse-nav2'}"><span class="am-icon-th"></span> 助攻报表</a>
														<ul class="am-list am-collapse admin-sidebar-sub"
														id="collapse-nav2">
														<li ><a href="pageServer.action?to=assistReportIndex"><span class="am-icon-cog"></span>助攻报表定义</a></li>
														<li><a href="pageServer.action?to=assistReportIndex"><span class="am-icon-cog"></span> 助攻报表配置</a></li>
														<li><a href="pageServer.action?to=assistReportIndex"><span class="am-icon-cog"></span> 非核心助攻渠道配置</a></li>
														</ul>
							
							</li>
						</ul>
					</li>
				</ul>

			</div>
		</div>

		<!-- sidebar end -->


		
		 <div class="admin-content">

    <div class="am-cf am-padding">
      <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">报表列表</strong> / <small>Table</small></div>
    </div>

    <div class="am-g">
      <div class="am-u-sm-12 am-u-md-6">
        <div class="am-btn-toolbar">
          <div class="am-btn-group am-btn-group-xs">
           <a href="admin-form.html"> <button type="button" class="am-btn am-btn-default"><span class="am-icon-plus"></span> 新增</button></a>
             <a href="#"> <button type="button" class="am-btn am-btn-default" data-am-modal="{target: '#confirm'}"><span class="am-icon-save"></span> 删除</button></a>
             <a href="javascript:void(0)" onclick="update()"> <button id=upd type="button" class="am-btn am-btn-default"><span class="am-icon-archive"></span> 修改</button></a>
             <a href="javascript:void(0)" onclick="config()"> <button id='config' type="button" class="am-btn am-btn-default"><span class="am-icon-archive"></span> 配置</button></a>
          </div>
        </div>
      </div>

    </div>

    <div class="am-g">
      <div class="am-u-sm-12">
        <form class="am-form">
          <table class="am-table am-table-striped am-table-hover table-main">
            <thead>
              <tr>
                <th class="table-check"></th><th class="table-title">报表名称</th>
              </tr>
          </thead>
          <tbody id="tbody">
           
          </tbody>
        </table>

          <hr />
      
        </form>
      </div>

    </div>
  </div>
  </div>
  

<div class="am-modal am-modal-confirm" tabindex="-1" id="confirm">
  <div class="am-modal-dialog">
    <div class="am-modal-bd">
         确定删除吗？
    </div>
    <div class="am-modal-footer">
      <span class="am-modal-btn" data-am-modal-cancel>取消</span>
      <span id="ok" class="am-modal-btn" data-am-modal-confirm>确定</span>
    </div>
  </div>
</div>
	
		<!-- content end -->





	<!--[if lt IE 9]>
<script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="assets/js/polyfill/rem.min.js"></script>
<script src="assets/js/polyfill/respond.min.js"></script>
<script src="assets/js/amazeui.legacy.js"></script>
<![endif]-->

	<!--[if (gte IE 9)|!(IE)]><!-->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/amazeui.min.js"></script>
	<!--<![endif]-->
	<script src="assets/js/app.js"></script>
	<script type="text/javascript"  src="js/common.js"></script>
	<script>
		function createShowingTable(data) {
		//	alert("------->进入当前的数据展现");
			//此处需要让其动态的生成一个table并填充数据  
			var tableStr = ""
			var len = data.length;
			for (var i = 0; i < len; i++) {
				tableStr = tableStr + "<tr><th class='table-check'><input type='checkbox' /></th><td><a href='score/getData.action?reportId="+data[i].id+"&calendar="+getYesterday()+"'>"+data[i].name+"</a></td><td style='display:none'>"+data[i].id+"</td></tr>";
			}
			//将动态生成的table添加的事先隐藏的div中.  
			$("#tbody").html(tableStr);
			$("table").show();
		}

	     function getList() {
				
							$.ajax({
										type : "GET",
										url : "ws/reportdef/report/definition/list",
										dataType : "json",
										success : function(data) {
											//返回来的data是json对象。
										//	alert("Data type: " +  typeof data);
											createShowingTable(data)
										},
										error : function(data) {

											alert("error occured");
										}
									})

						}
	     

	    	 function update(){
	    	 						if($("#tbody input[type='checkbox']:checked").length != 1){
	    	 							alert("请选择一项");
	    	 							return;
	    	 						}else{
	    	 						//	var $selector = $('td:nth-child(1)')
	    	 							var id = $("#tbody input[type='checkbox']:checked").parent().parent().find('td:nth-child(3)').text();
	    	 						  
	    	 							window.location.href = "pageServer.action?to=update&id="+id
	    	 						}
	    	 				}
	    	 				
	    	 function config(){
					if($("#tbody input[type='checkbox']:checked").length != 1){
						alert("请选择一项");
						return;
					}else{
						var $selector = $('td:nth-child(3)')
						var id = $("#tbody input[type='checkbox']:checked").parent().parent().find($selector).text();
						window.location.href = "pageServer.action?to=config&id="+id
					}
			}
	    	 
	    $("#ok").click(function (){
				if($("#tbody input[type='checkbox']:checked").length != 1){
						alert("请选择一项");
						return;
					}else{
				    	var id = $("#tbody input[type='checkbox']:checked").parent().parent().find('td:nth-child(3)').text();
						$.ajax({
							type : "DELETE",
							url : "ws/reportdef/report/definition/delete/"+id,
							dataType : "json",
							success : function(data) {
								alert("success");
								window.location.href = "admin-index.html"
							},
							error : function(data) {
			
								alert("error occured");
							}
						})
					}
	    	
	    })	 
	    	 
	     
	     getList();
	     
	</script>
</body>
</html>
